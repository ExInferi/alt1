!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("@alt1/base")):"function"==typeof define&&define.amd?define(["@alt1/base"],t):"object"==typeof exports?exports["@alt1/chatbox"]=t(require("@alt1/base")):e.Chatbox=t(e.A1lib)}("undefined"!=typeof self?self:this,function(e){return function(e){var t={};function A(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,A),i.l=!0,i.exports}return A.m=e,A.c=t,A.d=function(e,t,r){A.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},A.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},A.t=function(e,t){if(1&t&&(e=A(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(A.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)A.d(r,i,function(t){return e[t]}.bind(null,i));return r},A.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return A.d(t,"a",t),t},A.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},A.p="/",A(A.s=1)}([function(t,A){t.exports=e},function(e,t,A){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=A(0),i=r.ImageDetect.webpackImages({plusbutton:A(2),minusbutton:A(3),filterbutton:A(4),chatbubble:A(5),chatLegacyBorder:A(6),entertochat:A(7),gameoff:A(8),gamefilter:A(9),gameall:A(10),legacyreport:A(11),reportbutton:A(12)}),o=[[0,255,0],[0,255,255],[0,175,255],[0,0,255],[255,82,86],[159,255,159],[0,111,0],[255,143,143],[255,152,31],[255,111,0],[255,255,0],[239,0,0],[239,0,175],[255,79,255],[175,127,255],[48,48,48],[191,191,191],[127,255,255],[128,0,0],[255,255,255],[127,169,255],[255,140,56],[255,0,0],[69,178,71],[164,153,125],[215,195,119]],n=function(){function e(){this.pos=null,this.debug=null,this.overlaplines=[],this.readargs={backwards:!0,colors:o.map(function(e){return r.mixColor(e[0],e[1],e[2])})},this.lineheight=14,this.minoverlap=2,this.diffRead=!0}return e.prototype.read=function(e){Date.now();if(!this.pos)return null;var t=this.pos.mainbox;if(e||(e=r.captureHold(t.rect.x+(t.leftfound?0:-300),t.rect.y,t.rect.width+(t.leftfound?0:300),t.rect.height)),!e)return null;if(t.timestamp&&this.readargs.colors){var A=[r.mixColor(127,169,255),r.mixColor(255,255,255)];for(var i in A)-1==this.readargs.colors.indexOf(A[i])&&this.readargs.colors.push(A[i])}t.line0y,t.rect.y,e.y;for(var o=t.line0x+t.rect.x-e.x,n=[],a=[],l=0;;l++){var u=t.line0y-l*this.lineheight,g=u+t.rect.y-e.y;if(u-this.lineheight<0){a=n;break}var c=JSON.parse(alt1.bindReadStringEx(e.handle,o,g,JSON.stringify(this.readargs)));if(!c&&t.timestamp&&(c=JSON.parse(alt1.bindReadStringEx(e.handle,o+56,g,JSON.stringify(this.readargs)))),n.unshift(c||{text:"",fragments:[]}),this.diffRead&&n.length>=this.overlaplines.length&&this.overlaplines.length>=this.minoverlap){for(var s=!0,f=0;f<this.overlaplines.length;f++)if(!this.matchLines(this.overlaplines[f].text,n[f].text)){s=!1;break}if(s){a=n.slice(this.overlaplines.length,n.length);break}}}return this.overlaplines=this.overlaplines.concat(a),this.overlaplines.length>this.minoverlap&&this.overlaplines.splice(0,this.overlaplines.length-this.minoverlap),a},e.prototype.simplefyLine=function(e){return e=(e=e.replace(/[\[\]\.\':;,_ ]/g,"")).replace(/[|!lIji]/g,"l")},e.prototype.matchLines=function(e,t){return this.simplefyLine(e)==this.simplefyLine(t)},e.prototype.checkLegacyBG=function(e,t,A){return e.getColorDifference(t,A,155,140,107)<20},e.prototype.find=function(e){var t=this;if(e||(e=r.captureHoldFullRs()),!e)return null;var A=[];e.findSubimage(i.plusbutton).forEach(function(e){return A.push({x:e.x+2,y:e.y-1,type:"hidden"})}),e.findSubimage(i.minusbutton).forEach(function(e){return A.push({x:e.x+2,y:e.y+21,type:"full"})}),console.log(A);var o=[];if(e.findSubimage(i.chatbubble).forEach(function(t){var A=e.toData(t.x+102,t.y+1,33,10);if(A.pixelCompare(i.entertochat,0,1)!=1/0||A.pixelCompare(i.entertochat,5,1)!=1/0)o.push(t);else if(A.pixelCompare(i.entertochat,0,0)!=1/0||A.pixelCompare(i.entertochat,5,0)!=1/0)t.y-=1,o.push(t);else{var r=e.toData(t.x,t.y-2,1,1);255==r.data[0]&&255==r.data[1]&&255==r.data[2]?o.push(t):console.log("unlinked quickchat bubble "+JSON.stringify(t))}}),e.findSubimage(i.chatLegacyBorder).forEach(function(e){o.push({x:e.x,y:e.y-1})}),console.log(o),1==o.length&&0==A.length){var n=e.findSubimage(i.legacyreport);1==n.length&&A.push({x:n[0].x+32,y:n[0].y-170,type:"legacy"})}var a=[],l=0,u=function(){l++;var e=!0;for(var t in A)if(!a.find(function(e){return e.topright==A[t]}))for(var i in e=!1,o)if(!a.find(function(e){return e.botleft==o[i]})){var n={timestamp:!1,type:"main",leftfound:!1,topright:A[t],botleft:o[i],rect:new r.Rect(o[i].x,A[t].y,A[t].x-o[i].x,o[i].y-A[t].y),line0x:0,line0y:0};if(!a.find(function(e){return e.rect.overlaps(n.rect)})){if(a[a.length]=n,u())return!0;a.splice(a.length-1,1)}}return e};if(!u())return null;console.log(l),console.log(a);var g=null,c=JSON.stringify({colors:[r.mixColor(255,255,255)],backwards:!0});if(a.forEach(function(A){var r=JSON.parse(alt1.bindReadStringEx(e.handle,A.rect.x-10,A.rect.y+A.rect.height+9,c));if(r){var o=0;"Clan Chat"==r.text?(A.type="cc",o=62):"Friends Chat"==r.text?(A.type="fc",o=76):"Group Chat"==r.text?(A.type="gc",o=69):"Guest Clan Chat"==r.text&&(A.type="gcc",o=98),0!=o&&(A.rect.x-=o,A.rect.width+=o,A.leftfound=!0)}if(!A.leftfound&&"full"==A.topright.type){var n=[];if(0==n.length&&(n=e.findSubimage(i.gameall,A.rect.x-300,A.rect.y-22,310,16)),0==n.length&&(n=e.findSubimage(i.gamefilter,A.rect.x-300,A.rect.y-22,310,16)),0==n.length&&(n=e.findSubimage(i.gameoff,A.rect.x-300,A.rect.y-22,310,16)),0!=n.length){A.leftfound=!0;o=A.rect.x-n[0].x;A.rect.x-=o,A.rect.width+=o}}A.line0x=0,A.line0y=A.rect.height-10,A.leftfound&&(A.timestamp=t.checkTimestamp(e,A)),null!=g&&"main"!=A.type||(g=A)}),0==a.length)return null;var s={mainbox:g,boxes:a};return this.pos=s,s},e.prototype.checkTimestamp=function(e,t){for(var A={colors:[r.mixColor(127,169,255)]},i=0;i<3;i++){var o=t.rect.y+t.line0y-i*this.lineheight,n=t.rect.x+t.line0x;n+=3;var a=JSON.parse(alt1.bindReadStringEx(e.handle,n,o,JSON.stringify(A)));if(a&&a.text.match(/^\d\d:\d\d:\d\d/))return!0}return!1},e.getFontColor=function(e,t,A,r,i){for(var o=-1/0,n=0,a=0,l=e.data,u=t;u<t+r-1;u++)for(var g=A;g<A+i-1;g++){var c=4*u+4*e.width*g,s=4*(u+1)+4*e.width*(g+1),f=l[c]+l[c+1]+l[c+2],h=l[s]+l[s+1]+l[s+2],p=Math.min(255,275-h)*f;p>o&&(o=p,n=u,a=g)}return e.getPixel(n,a)},e}();t.ChatBoxReader=n},function(e,t,A){e.exports=A(0).ImageDetect.imageDataFromBase64("iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAIAAACQKrqGAAABT0lEQVQoU2PIzMk01hbUVGDDg4AKgMoYgFRLCPOOOtbdLWxAtLeTHYIgXKA4EAEVAJUxaMizbilju75E9u4mNSC6sVoVguBcoNTuZm6gMgYVWVYg6+EO3Ue7jYHo3irjIFOmYAumWztBXCC6tVwLqACoDEXprS1GQARUCkQQdSDBbahKgVovr9Y5u1j78jItTz0mIAJyIQjohp1VfDClNcJwFa6a6OjyPCUUpUAnAkUd1BiByEYJBQEt3FwkgqL04Qq7x+u9gCRQ2kKOEc69NcsQoXRXpcy9ORoQdKVL2USaEYhu9irdmawKREDG1lxRdKVACaAZ2iIMQHS1UweoDYJQlAL516aAjAQqvTLJBogutBmca1CCoE2pkiClqnIczSF8O4pkd9arAMktmdJAEoKAKoBcIKpx4QYqY9AxMQDqkJdkkRXHjoBSQAU6JgYAwvDKbZkKUHAAAAAASUVORK5CYII=")},function(e,t,A){e.exports=A(0).ImageDetect.imageDataFromBase64("iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAIAAACQKrqGAAABL0lEQVQoU2PIzMk01hbUVGDDg4AKgMoYgFRLCPOOOtbdLWxAtLeTHYIgXKA4EAEVAJUxaMizbilju75E9u4mNUx0Y7UqUGp3MzdQGYOKLCuQ9XCH7qPdxg+2Gt3aYgQkgWw4AqoGKgAqQ1EKVIep9NY2LRSlt5ZrXV6tc3axNgRdXgbiQhDQ1J1VfDClNcJAuSBTJjjy1GNy1WSyUWI0kWa8PE8JRem9VcaYirRFGIAIaOHmIhEUpQ9X2D1e74WGgIK3ZhluzRWFKt1VKXNvjgYE3exVujNZFYiQGViUQuSudCkD0bkGJSAJVAckUZQC+demaMBJoDpktClVEqRUVY6jOYRvR5HsznoVILklUxpIQhCQDUE1LtxAZQw6JgZAHfKSLLLi2BFQCqhAx8QAACI62b/ivxHFAAAAAElFTkSuQmCC")},function(e,t,A){e.exports=A(0).ImageDetect.imageDataFromBase64("iVBORw0KGgoAAAANSUhEUgAAAA4AAAAPCAYAAADUFP50AAAAaElEQVQ4T9XLsQ2AMAxEUc+BxBysySTsQcEI7EF36JAcORdHoUMUv8jFz65jgXZuU2lf5zQD0OARonkg4+Eb6PcFMgc9GG8ryHpQ76qHp1D/WTOwCPXPS8fvINM/Lx1/CHWPpeMIAbAba/5W9dGOZAMAAAAASUVORK5CYII=")},function(e,t,A){e.exports=A(0).ImageDetect.imageDataFromBase64("iVBORw0KGgoAAAANSUhEUgAAAA0AAAAJCAYAAADpeqZqAAAAoElEQVQoU5WRwQ3DIAxF2Sg9t1KvySSM0d46AgNw55aukAzAAizADE6eIxCy1EMPH4z9nxHGiYjq835JCEG+69rF2Xsv87zIbZpO2+XtQM5ZSilSa1URo23btUGMsYOOThRGYARpZkGFKFjAQiil9D/EbQrxSBIYrCzQb3o873qggMkam3gP01SIaRCQHE00ItfMDdDpsTTwl/gS9ssr7gAl2lnMS+w6XAAAAABJRU5ErkJggg==")},function(e,t,A){e.exports=A(0).ImageDetect.imageDataFromBase64("iVBORw0KGgoAAAANSUhEUgAAAAQAAAAPCAIAAABMVPnqAAAAIUlEQVQYV2P4jwRAnNk92RA0mDjzJuRCOUAWlAMF//8DAJmOfBu3Ydq7AAAAAElFTkSuQmCC")},function(e,t,A){e.exports=A(0).ImageDetect.imageDataFromBase64("iVBORw0KGgoAAAANSUhEUgAAABgAAAAJCAYAAAAo/ezGAAAAdElEQVQ4T62RSw7AIAhEOQTH8WCsXbvmuhRsTdQipqYmz88MJI4CM0tDB/zNPelipJT06Bee4oo9UbqV1+uDscLS5Zx163ulFN2OOiLWVxnEE1YpGq74FSISu/GsGy/hhDBBixgVecw9YYL6GQ+9uWPfI3ABK/Blt6d3IYgAAAAASUVORK5CYII=")},function(e,t,A){e.exports=A(0).ImageDetect.imageDataFromBase64("iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAdUlEQVQ4T62MsQrAIAxE/bwOhS7tkMHBLi79/zVthAvaCjZq4MFx5J6jePEI8wTPOQsq2M/YJcAuBQHlH/LfuQILVQFyi0Kw+cCClMgt8t9CYEEFK3kVINfAEKBPI0FK5BoYAvSFwIIKloNYeD+0+Ah6GRQQ30BWZJSYN2VIAAAAAElFTkSuQmCC")},function(e,t,A){e.exports=A(0).ImageDetect.imageDataFromBase64("iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAqUlEQVQ4T63MsQrCQBAE0P1LSzs7Sy3tBEvtFDFNwMYurVhY2lgKfkHyBXbJ6AQm3AnHcaeBB3ubnbGiaVE0XZZD3cI2jxd+MRR8Pkvxv4LVrQa5yxjeKucVaI7xChaXJ4jLFMp5BZpjvIJ5dQdxqTnGvbXZ6QriMoVyNi3PIC41E3+6bwVFe69gsq8QoqAMBaGDGOVsvD5mFzDbF7jUHPJ9b6PlDvm2eAMxAQErxoTm+QAAAABJRU5ErkJggg==")},function(e,t,A){e.exports=A(0).ImageDetect.imageDataFromBase64("iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAo0lEQVQ4T6XMsQkCQRAF0KnA5DA0MDG3A2uwlQuN7cVY07vgAkPBTA3FAixA5esXvuyeC+O6Cw+Gv/PH7oc5Hsf/sGupjxx2289Ar2c51LNrNwX1FzzqRQc0e6ID580YxFCzJ9y1y3oIYphDPTutBiCGmj3hbvmB3XICYphDveiA5hQVRfnXge1i9KY8/A9p7zP0FzzqlR9o6wolrEmEv2rqCk/yGcSB9N78JQAAAABJRU5ErkJggg==")},function(e,t,A){e.exports=A(0).ImageDetect.imageDataFromBase64("iVBORw0KGgoAAAANSUhEUgAAACEAAAALCAYAAADx0+Q/AAAAlElEQVQ4T72OCQ4AIQgD/f+nXYuUgGLiukeTQVq8Sp2F7FdQWi2GKmz6CEh6Mfq4DQf/FfaO1EFt1ocKRX+SQ35lD/ErPcOafICfgp7kEGe9tF6gwYKiK/GaLrjbOx/mwSiQ9Ty8uuCgJ5YFo0zeKc0W+30+3kkgmYyXpJ5oZt5lRpZn+4DszQYbpI+fkoY7vPeJWi767hYjK0Ud6gAAAABJRU5ErkJggg==")},function(e,t,A){e.exports=A(0).ImageDetect.imageDataFromBase64("iVBORw0KGgoAAAANSUhEUgAAAA8AAAAQCAYAAADJViUEAAABAElEQVQ4T6WSvwtBURTHj0V+FknyB6AMZCH8ATbxByijwb9gsFsMBrvJaFAGu00sJilltlp0+N7Xua7rySuvPr1z7z2f77m9Ht0PdQbPR9cm2P8G3TZlBli4yUCabd5kqUG/W+FmI+8aJtB1lWUAWWrIvXaSS8WsCpHA9cg5E1xlQQJOi5y6RToVVQHST8d5nAEWUguXpSNDAoOOswc+5P0sxgL2MNkUzV4lo3E7DaoNvAWIkbCfC5moYtIL6OCfcqsWUqDGVATZAVqwZbAeJ/QbVyfy8WyYesnm5G+gBwG4gUwG+iPZgs3OkATPshuEHwDYB16g86LKwD7wwh8y0wNntoLFjD8QsQAAAABJRU5ErkJggg==")}])});