{"version":3,"sources":["webpack://A1lib/webpack/universalModuleDefinition","webpack://A1lib/webpack/bootstrap","webpack://A1lib/./imagedata-extensions.ts","webpack://A1lib/./imagedetect.ts","webpack://A1lib/./imgref.ts","webpack://A1lib/./index.ts","webpack://A1lib/./pasteinput.ts","webpack://A1lib/./rect.ts","webpack://A1lib/./wrapper.ts","webpack://A1lib/external {\"root\":\"unkown\",\"commonjs\":\"node-fetch\",\"commonjs2\":\"node-fetch\",\"amd\":\"node-fetch\"}","webpack://A1lib/external {\"root\":\"unkown\",\"commonjs\":\"pngjs\",\"commonjs2\":\"pngjs\",\"amd\":\"pngjs\"}"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"node-fetch\"), require(\"pngjs\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"node-fetch\", \"pngjs\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"@alt1/base\"] = factory(require(\"node-fetch\"), require(\"pngjs\"));\n\telse\n\t\troot[\"A1lib\"] = factory(root[\"unkown\"], root[\"unkown\"]);\n})((typeof self!='undefined'?self:this), function(__WEBPACK_EXTERNAL_MODULE_node_fetch__, __WEBPACK_EXTERNAL_MODULE_pngjs__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","import * as a1lib from \"./index\";\r\n\r\ndeclare global {\r\n\tinterface ImageData {\r\n\t\tputImageData(buf: ImageData, cx: number, cy: number): void;\r\n\t\tpixelOffset(x: number, y: number): number;\r\n\t\tgetPixelHash(rect: a1lib.RectLike): number;\r\n\r\n\t\tclone(rect: a1lib.RectLike): ImageData;\r\n\r\n\t\tshow(x?: number, y?: number, zoom?: number): HTMLCanvasElement;\r\n\r\n\t\ttoImage(rect?: a1lib.RectLike): HTMLCanvasElement;\r\n\r\n\t\tgetPixel(x: number, y: number): [number, number, number, number];\r\n\t\tgetPixelInt(x: number, y: number): number;\r\n\t\tgetColorDifference(x: number, y: number, r: number, g: number, b: number, a?: number): number;\r\n\r\n\r\n\t\tsetPixel(x: number, y: number, color: [number, number, number, number]): void;\r\n\t\tsetPixel(x: number, y: number, r: number, g: number, b: number, a: number): void;\r\n\r\n\t\tsetPixelInt(x: number, y: number, color: number): void;\r\n\r\n\t\ttoJSON(rect?: a1lib.RectLike): string;\r\n\r\n\t\tpixelCompare(buf: ImageData, x?: number, y?: number, max?: number): number;\r\n\r\n\t\tcopyTo(target: ImageData, sourcex: number, sourcey: number, width: number, height: number, targetx: number, targety: number): void;\r\n\t}\r\n\r\n\tinterface HTMLImageElement {\r\n\t\ttoBuffer(x?: number, y?: number, w?: number, h?: number): ImageData;\r\n\t\ttoCanvas(x?: number, y?: number, w?: number, h?: number): HTMLCanvasElement;\r\n\t}\r\n}\r\n\r\n\r\ntype ImageDataConstr = {\r\n\tprototype: ImageData;\r\n\tnew(width: number, height: number): ImageData;\r\n\tnew(array: Uint8ClampedArray, width: number, height: number): ImageData;\r\n};\r\n\r\n\r\n//export this so node.js can also use it\r\nexport var ImageData: ImageDataConstr;\r\n\r\n(function () {\r\n\tvar globalvar = (typeof self != \"undefined\" ? self : (typeof (global as any) != \"undefined\" ? (global as any) : null)) as any;\r\n\tvar fill = typeof globalvar.ImageData == \"undefined\";\r\n\r\n\tvar constr = function (this: any) {\r\n\t\tvar i = 0;\r\n\t\tvar data = (arguments[i] instanceof Uint8ClampedArray ? arguments[i++] : null);\r\n\t\tvar width = arguments[i++];\r\n\t\tvar height = arguments[i++];\r\n\r\n\t\tif (fill) {\r\n\t\t\tif (!data) { data = new Uint8ClampedArray(width * height * 4); }\r\n\t\t\tthis.width = width;\r\n\t\t\tthis.height = height;\r\n\t\t\tthis.data = data;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar canvas = document.createElement('canvas');\r\n\t\t\tcanvas.width = width;\r\n\t\t\tcanvas.height = height;\r\n\t\t\tvar ctx = canvas.getContext(\"2d\");\r\n\t\t\tvar imageData = ctx.createImageData(width, height);\r\n\t\t\tif (data) { imageData.data.set(data); }\r\n\t\t\treturn imageData;\r\n\t\t}\r\n\t}\r\n\tif (!fill) { constr.prototype = globalvar.ImageData.prototype; }\r\n\tglobalvar.ImageData = constr;\r\n\tImageData = constr as any;\r\n})();\r\n\r\n\r\n\r\nImageData.prototype.putImageData = function (buf, cx, cy) {\r\n\tfor (var dx = 0; dx < buf.width; dx++) {\r\n\t\tfor (var dy = 0; dy < buf.height; dy++) {\r\n\t\t\tvar i1 = (dx + cx) * 4 + (dy + cy) * 4 * this.width;\r\n\t\t\tvar i2 = dx * 4 + dy * 4 * buf.width;\r\n\t\t\tthis.data[i1] = buf.data[i2];\r\n\t\t\tthis.data[i1 + 1] = buf.data[i2 + 1];\r\n\t\t\tthis.data[i1 + 2] = buf.data[i2 + 2];\r\n\t\t\tthis.data[i1 + 3] = buf.data[i2 + 3];\r\n\t\t}\r\n\t}\r\n}\r\n\r\nImageData.prototype.pixelOffset = function (x, y) {\r\n\treturn x * 4 + y * this.width * 4;\r\n}\r\n\r\n//creates a hash of a portion of the buffer used to check for changes\r\nImageData.prototype.getPixelHash = function (rect) {\r\n\tif (!rect) { rect = new a1lib.Rect(0, 0, this.width, this.height); }\r\n\tvar hash = 0;\r\n\tfor (var x = rect.x; x < rect.x + rect.width; x++) {\r\n\t\tfor (var y = rect.y; y < rect.y + rect.height; y++) {\r\n\t\t\tvar i = x * 4 + y * 4 * this.width;\r\n\r\n\t\t\thash = (((hash << 5) - hash) + this.data[i]) | 0;\r\n\t\t\thash = (((hash << 5) - hash) + this.data[i + 1]) | 0;\r\n\t\t\thash = (((hash << 5) - hash) + this.data[i + 2]) | 0;\r\n\t\t\thash = (((hash << 5) - hash) + this.data[i + 3]) | 0;\r\n\t\t}\r\n\t}\r\n\treturn hash;\r\n}\r\n\r\nImageData.prototype.clone = function (rect) {\r\n\treturn this.toImage(rect).getContext(\"2d\").getImageData(0, 0, rect.width, rect.height);\r\n}\r\n\r\nImageData.prototype.show = function (x = 5, y = 5, zoom = 1) {\r\n\tvar imgs = document.getElementsByClassName(\"debugimage\");\r\n\twhile (imgs.length > 10) { imgs[0].remove(); }\r\n\tvar el = this.toImage();\r\n\tel.classList.add(\"debugimage\")\r\n\tel.style.position = \"absolute\";\r\n\tel.style.zIndex = \"1000\";\r\n\tel.style.left = x / zoom + \"px\";\r\n\tel.style.top = y / zoom + \"px\";\r\n\tel.style.background = \"purple\";\r\n\tel.style.cursor = \"pointer\";\r\n\t(el.style as any).imageRendering = \"pixelated\";\r\n\tel.style.outline = \"1px solid #0f0\";\r\n\tel.style.width = (this.width == 1 ? 100 : this.width) + \"px\";\r\n\tel.style.height = (this.height == 1 ? 100 : this.height) + \"px\";\r\n\tel.onclick = function () { el.remove(); }\r\n\tdocument.body.appendChild(el);\r\n\treturn el;\r\n}\r\n\r\nImageData.prototype.toImage = function (rect?) {\r\n\tif (!rect) { rect = new a1lib.Rect(0, 0, this.width, this.height); }\r\n\r\n\tvar el = document.createElement(\"canvas\");\r\n\tel.width = rect.width;\r\n\tel.height = rect.height;\r\n\tvar ctx = el.getContext(\"2d\");\r\n\tctx.putImageData(this, -rect.x, -rect.y);\r\n\treturn el;\r\n}\r\n\r\nImageData.prototype.getPixel = function (x, y): [number, number, number, number] {\r\n\tvar i = x * 4 + y * 4 * this.width;\r\n\treturn [this.data[i], this.data[i + 1], this.data[i + 2], this.data[i + 3]];\r\n}\r\n\r\nImageData.prototype.getPixelInt = function (x, y) {\r\n\tvar i = x * 4 + y * 4 * this.width;\r\n\treturn (this.data[i + 3] << 24) + (this.data[i + 0] << 16) + (this.data[i + 1] << 8) + (this.data[i + 2] << 0);\r\n}\r\n\r\nImageData.prototype.getColorDifference = function (x, y, r, g, b, a = 255) {\r\n\tvar i = x * 4 + y * 4 * this.width;\r\n\treturn Math.abs(this.data[i] - r) + Math.abs(this.data[i + 1] - g) + Math.abs(this.data[i + 2] - b) * a / 255;\r\n}\r\n\r\nImageData.prototype.setPixel = function (x, y, ...color) {\r\n\tvar r, g, b, a;\r\n\tvar [r, g, b, a] = (Array.isArray(color[0]) ? color[0] : color);\r\n\tvar i = x * 4 + y * 4 * this.width;\r\n\tthis.data[i] = r;\r\n\tthis.data[i + 1] = g;\r\n\tthis.data[i + 2] = b;\r\n\tthis.data[i + 3] = a == undefined ? 255 : a;\r\n}\r\n\r\nImageData.prototype.setPixelInt = function (x, y, color) {\r\n\tvar i = x * 4 + y * 4 * this.width;\r\n\tthis.data[i] = (color >> 24) & 0xff;\r\n\tthis.data[i + 1] = (color >> 16) & 0xff;\r\n\tthis.data[i + 2] = (color >> 8) & 0xff;\r\n\tthis.data[i + 3] = (color >> 0) & 0xff;\r\n}\r\n\r\nImageData.prototype.toJSON = function (rect?) {\r\n\tvar str: string = this.toImage(rect).toDataURL(\"image/png\");\r\n\treturn str.slice(str.indexOf(\",\") + 1);\r\n}\r\n\r\nImageData.prototype.pixelCompare = function (buf: ImageData, x = 0, y = 0, max?: number) {\r\n\treturn a1lib.ImageDetect.simpleCompare(this, buf, x, y, max);\r\n}\r\n\r\nImageData.prototype.copyTo = function (target: ImageData, sourcex: number, sourcey: number, width: number, height: number, targetx: number, targety: number) {\r\n\tfor (var cx = 0; cx < width; cx++) {\r\n\t\tfor (var cy = 0; cy < height; cy++) {\r\n\t\t\tvar it = (cx + targetx) * 4 + (cy + targety) * target.width * 4;\r\n\t\t\tvar is = (cx + sourcex) * 4 + (cy + sourcey) * this.width * 4;\r\n\t\t\ttarget.data[it + 0] = this.data[is + 0];\r\n\t\t\ttarget.data[it + 1] = this.data[is + 1];\r\n\t\t\ttarget.data[it + 2] = this.data[is + 2];\r\n\t\t\ttarget.data[it + 3] = this.data[is + 3];\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\n\r\nif (typeof HTMLImageElement != \"undefined\") {\r\n\tHTMLImageElement.prototype.toBuffer = function (this: HTMLImageElement, x = 0, y = 0, w = this.width, h = this.height) {\r\n\t\tvar cnv = document.createElement(\"canvas\");\r\n\t\tcnv.width = w;\r\n\t\tcnv.height = h;\r\n\t\tvar ctx = cnv.getContext(\"2d\");\r\n\t\tctx.drawImage(this, -x, -y);\r\n\t\treturn ctx.getImageData(0, 0, w, h);\r\n\t}\r\n\r\n\tHTMLImageElement.prototype.toCanvas = function (this: HTMLImageElement, x = 0, y = 0, w = this.width, h = this.height) {\r\n\t\tvar cnv = document.createElement(\"canvas\");\r\n\t\tcnv.width = w;\r\n\t\tcnv.height = h;\r\n\t\tvar ctx = cnv.getContext(\"2d\");\r\n\t\tctx.drawImage(this, -x, -y);\r\n\t\treturn cnv;\r\n\t}\r\n}","import { ImgRef, ImgRefBind } from \"./imgref\";\r\nimport * as wapper from \"./wrapper\";\r\n\r\n\r\n/**\r\n* Downloads an image and returns the ImageData\r\n* Make sure the png image does not have a sRGB chunk or the resulting pixels will differ for different users!!!\r\n* @param url http(s) or data url to the image\r\n*/\r\nexport async function imageDataFromUrl(url: string): Promise<ImageData> {\r\n\tif (typeof Image != \"undefined\") {\r\n\t\tvar img = new Image();\r\n\t\timg.crossOrigin = \"crossorigin\";\r\n\t\treturn await new Promise((done, fail) => {\r\n\t\t\timg.onload = function () { done(img.toBuffer()); };\r\n\t\t\timg.onerror = fail;\r\n\t\t\timg.src = url;\r\n\t\t}) as ImageData;\r\n\t} else {\r\n\t\t//polyfill if we're not running in browser\r\n\t\tvar nodefetch = require(\"node-fetch\") as typeof fetch;\r\n\t\tvar pngjs = require(\"pngjs\");\r\n\t\tvar imgovr = require(\"@alt1/base/imagedata-extensions\").ImageData as typeof ImageData;\r\n\t\tvar hdr = \"data:image/png;base64,\";\r\n\t\tif (url.startsWith(hdr)) {\r\n\t\t\tvar raw = Buffer.from(url.slice(hdr.length), \"base64\");\r\n\t\t\tvar buffer = new Uint8Array(raw.buffer, raw.byteOffset, raw.byteLength);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar res = await nodefetch(url).then(r => r.arrayBuffer());\r\n\t\t\tvar buffer = new Uint8Array(res);\r\n\t\t}\r\n\t\tclearPngColorspace(buffer);\r\n\t\tvar png = new pngjs.PNG();\r\n\t\tawait new Promise((done, err) => {\r\n\t\t\tpng.on(\"parsed\", (e: any) => done(e));\r\n\t\t\tpng.on(\"error\", (e: any) => err(e));\r\n\t\t\tpng.parse(Buffer.from(buffer.buffer, buffer.byteOffset, buffer.byteLength));\r\n\t\t});\r\n\r\n\t\treturn new imgovr(new Uint8ClampedArray(png.data.buffer, png.data.byteOffset, png.data.byteLength), png.width, png.height);\r\n\t}\r\n}\r\n\r\n/**\r\n* Loads an ImageData object from a base64 encoded png image\r\n* Make sure the png image does not have a sRGB chunk or the resulting pixels will differ for different users!!!\r\n* @param data a base64 encoded png image\r\n*/\r\nexport async function imageDataFromBase64(data: string) {\r\n\treturn imageDataFromUrl(\"data:image/png;base64,\" + data);\r\n}\r\n\r\n/**\r\n* Used to visualise data as a grayscale image. The imput array must contain one (float) value per pixel.\r\n* The values are automatically scaled so the lowest value is black and the highest is white\r\n* @param array The pixels, one values per pixel\r\n*/\r\nfunction imagedataFromArray(array: number[], w: number, h: number) {\r\n\tif (array.length != w * h) { throw new Error(\"Invalid array size\"); }\r\n\tvar min = Math.min.apply(null, array);\r\n\tvar max = Math.max.apply(null, array);\r\n\tvar range = max - min;\r\n\tvar buf = new ImageData(w, h);\r\n\tfor (var i = 0; i < w * h; i++) {\r\n\t\tvar ibuf = i * 4;\r\n\t\tbuf.data[ibuf] = buf.data[ibuf + 1] = buf.data[ibuf + 2] = (array[i] - min) / range * 255;\r\n\t\tbuf.data[ibuf + 3] = 255;\r\n\t}\r\n\treturn buf;\r\n}\r\n\r\n\r\n/**\r\n* Checks if a given byte array is a png file (by checking for ?PNG as first 4 bytes)\r\n* @param bytes Raw bytes of the png file\r\n*/\r\nexport function isPngBuffer(bytes: Uint8Array) {\r\n\treturn bytes[0] == 137 && bytes[1] == 80 && bytes[2] == 78 && bytes[3] == 71;\r\n}\r\n/**\r\n* Resets the colorspace data in the png file.\r\n* This makes sure the browser renders the exact colors in the file instead of filtering it in order to obtain the best real life representation of\r\n* what it looked like on the authors screen. (this feature is often broken and not supported)\r\n* For example a round trip printscreen -> open in browser results in different colors than the original\r\n* @param data Raw bytes of the png file\r\n*/\r\nexport function clearPngColorspace(data: Uint8Array) {\r\n\tif (!isPngBuffer(data)) { throw new Error(\"non-png image received\"); }\r\n\tvar i = 8;\r\n\twhile (i < data.length) {\r\n\t\tvar length = data[i++] * 0x1000000 + data[i++] * 0x10000 + data[i++] * 0x100 + data[i++];\r\n\t\tvar chunkname = String.fromCharCode(data[i++], data[i++], data[i++], data[i++]);\r\n\t\t//qw(chunkname, length);\r\n\t\tif (chunkname == \"sRGB\") {\r\n\t\t\t//Set render intent to absole colormetric, this forces browsers to not mess with the image\r\n\t\t\tconsole.log(\"- Changed sRGB, old value:\", data[i]);\r\n\t\t\t//new chunk data\r\n\t\t\tdata[i] = 3;\r\n\t\t\t//new chunk checksum\r\n\t\t\tdata[i + length + 0] = 0x37;\r\n\t\t\tdata[i + length + 1] = 0xc7;\r\n\t\t\tdata[i + length + 2] = 0x4d;\r\n\t\t\tdata[i + length + 3] = 0x53;\r\n\t\t}\r\n\t\tif (chunkname == \"IEND\") {\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\ti += length;\r\n\t\ti += 4;\r\n\t}\r\n}\r\n\r\n/**\r\n* finds the given needle ImageBuffer in the given haystack ImgRef this function uses the best optimized available\r\n* code depending on the type of the haystack. It will use fast c# searching if the haystack is an ImgRefBind, js searching\r\n* is used otherwise.\r\n* the checklist argument is no longer used and should ignored or null/undefined\r\n* The optional sx,sy,sw,sh arguments indicate a bounding rectangle in which to search the needle. The rectangle should be bigger than the needle\r\n* @returns An array of points where the needle is found. The array is empty if none are found\r\n*/\r\nexport function findSubimage(haystackImgref: ImgRef, needleBuffer: ImageData, sx = 0, sy = 0, sw = haystackImgref.width, sh = haystackImgref.height) {\r\n\tif (!haystackImgref) { throw new TypeError(); }\r\n\tif (!needleBuffer) { throw new TypeError(); }\r\n\r\n\tvar max = 30;\r\n\r\n\t//check if we can do this in alt1\r\n\tif (haystackImgref instanceof ImgRefBind && wapper.hasAlt1 && alt1.bindFindSubImg) {\r\n\t\tvar needlestr = wapper.encodeImageString(needleBuffer);\r\n\t\tvar r = alt1.bindFindSubImg(haystackImgref.handle, needlestr, needleBuffer.width, sx, sy, sw, sh);\r\n\t\tif (!r) { throw new wapper.Alt1Error(); }\r\n\t\treturn JSON.parse(r) as { x: number, y: number }[];\r\n\t}\r\n\r\n\treturn findSubbuffer(haystackImgref.read(), needleBuffer, sx, sy, sw, sh);\r\n}\r\n\r\n/**\r\n* Uses js to find the given needle ImageBuffer in the given haystack ImageBuffer. It is better to use the alt1.bind- functions in\r\n* combination with a1nxt.findsubimg.\r\n* the optional sx,sy,sw,sh arguments indicate a bounding rectangle in which to search.\r\n* @returns An array of points where the needle is found. The array is empty if none are found\r\n*/\r\nexport function findSubbuffer(haystack: ImageData, needle: ImageData, sx = 0, sy = 0, sw = haystack.width, sh = haystack.height) {\r\n\tvar r: { x: number, y: number }[] = [];\r\n\tvar maxdif = 30;\r\n\tvar maxresults = 50;\r\n\tvar needlestride = needle.width * 4;\r\n\tvar heystackstride = haystack.width * 4;\r\n\r\n\t//built list of non trans pixel to check\r\n\tvar checkList = [];\r\n\tfor (var x = 0; x < needle.width; x++) {\r\n\t\tfor (var y = 0; y < needle.height; y++) {\r\n\t\t\tvar i = x * 4 + y * needlestride;\r\n\t\t\tif (needle.data[i + 3] == 255) { checkList.push({ x: x, y: y }); }\r\n\t\t\tif (checkList.length == 10) { break; }\r\n\t\t}\r\n\t\tif (checkList.length == 10) { break; }\r\n\t}\r\n\r\n\tvar cw = (sx + sw) - needle.width;\r\n\tvar ch = (sy + sh) - needle.height;\r\n\tvar checklength = checkList.length;\r\n\tfor (var x = sx; x <= cw; x++) {\r\n\t\touter: for (var y = sy; y <= ch; y++) {\r\n\t\t\tfor (var a = 0; a < checklength; a++) {\r\n\t\t\t\tvar i1 = (x + checkList[a].x) * 4 + (y + checkList[a].y) * heystackstride;\r\n\t\t\t\tvar i2 = checkList[a].x * 4 + checkList[a].y * needlestride;\r\n\r\n\t\t\t\tvar d = 0;\r\n\t\t\t\td = d + Math.abs(haystack.data[i1 + 0] - needle.data[i2 + 0]) | 0;\r\n\t\t\t\td = d + Math.abs(haystack.data[i1 + 1] - needle.data[i2 + 1]) | 0;\r\n\t\t\t\td = d + Math.abs(haystack.data[i1 + 2] - needle.data[i2 + 2]) | 0;\r\n\t\t\t\td *= 255 / needle.data[i2 + 3];\r\n\t\t\t\tif (d > maxdif) {\r\n\t\t\t\t\tcontinue outer;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (simpleCompare(haystack, needle, x, y, maxdif) != Infinity) {\r\n\t\t\t\tr.push({ x, y });\r\n\t\t\t\tif (r.length > maxresults) { return r; }\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn r;\r\n}\r\n\r\n/**\r\n* Compares two images and returns the average color difference per pixel between them\r\n* @param max The max color difference at any point in the image before short circuiting the function and returning Infinity. set to -1 to always continue.\r\n* @returns The average color difference per pixel or Infinity if the difference is more than max at any point in the image\r\n*/\r\nexport function simpleCompare(bigbuf: ImageData, checkbuf: ImageData, x: number, y: number, max = 30) {\r\n\tif (x < 0 || y < 0) { throw new RangeError(); }\r\n\tif (x + checkbuf.width > bigbuf.width || y + checkbuf.height > bigbuf.height) { throw new RangeError(); }\r\n\r\n\tif (max == -1) { max = 255 * 4; }\r\n\tvar go = true;\r\n\r\n\tvar dif = 0;\r\n\tfor (var step = 8; step >= 1; step /= 2) {\r\n\t\tfor (var cx = 0; cx < checkbuf.width; cx += step) {\r\n\t\t\tfor (var cy = 0; cy < checkbuf.height; cy += step) {\r\n\t\t\t\tvar i1 = (x + cx) * 4 + (y + cy) * bigbuf.width * 4;\r\n\t\t\t\tvar i2 = cx * 4 + cy * checkbuf.width * 4;\r\n\t\t\t\tvar d = 0;\r\n\t\t\t\td = d + Math.abs(bigbuf.data[i1 + 0] - checkbuf.data[i2 + 0]) | 0;\r\n\t\t\t\td = d + Math.abs(bigbuf.data[i1 + 1] - checkbuf.data[i2 + 1]) | 0;\r\n\t\t\t\td = d + Math.abs(bigbuf.data[i1 + 2] - checkbuf.data[i2 + 2]) | 0;\r\n\t\t\t\td *= checkbuf.data[i2 + 3] / 255;\r\n\t\t\t\tif (step == 1) { dif += d; }\r\n\t\t\t\tif (d > max) { return Infinity; }\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn dif / checkbuf.width / checkbuf.height;\r\n}\r\n\r\n/**\r\n* Returns the difference between two colors (scaled to the alpha of the second color)\r\n*/\r\nexport function coldif(r1: number, g1: number, b1: number, r2: number, g2: number, b2: number, a2: number) {\r\n\treturn (Math.abs(r1 - r2) + Math.abs(g1 - g2) + Math.abs(b1 - b2)) * a2 / 255;//only applies alpha for 2nd buffer!\r\n}\r\n\r\n/**\r\n * Turns map of promises into a map that contains the resolved values after loading.\r\n * @param input\r\n */\r\nexport function asyncMap<T extends { [name: string]: Promise<any> }>(input: T) {\r\n\t//recusive types what xd\r\n\ttype subt = { [K in keyof T]: T[K] extends Promise<infer U> ? U : any };\r\n\tvar raw = {} as subt;\r\n\tvar promises = [];\r\n\r\n\tfor (var a in input) {\r\n\t\tif (input.hasOwnProperty(a)) {\r\n\t\t\traw[a] = null;\r\n\t\t\tpromises.push(input[a].then(function (a: keyof T, i: any) { raw[a] = i; r[a] = i; }.bind(null, a)));\r\n\t\t}\r\n\t}\r\n\tvar r = {} as subt & { promise: Promise<subt>, loaded: boolean, raw: subt };\r\n\tvar promise = Promise.all(promises).then(() => { r.loaded = true; return r; });\r\n\tObject.defineProperty(r, \"loaded\", { enumerable: false, value: false, writable: true });\r\n\tObject.defineProperty(r, \"promise\", { enumerable: false, value: promise });\r\n\tObject.defineProperty(r, \"raw\", { enumerable: false, value: raw });\r\n\treturn Object.assign(r, raw);\r\n}\r\n\r\n/**\r\n* Same as asyncMap, but casts the properties to ImageData in typescript\r\n*/\r\nexport function webpackImages<T extends { [name: string]: Promise<ImageData> }>(input: T) {\r\n\ttype subt = { [K in keyof T]: ImageData };\r\n\treturn asyncMap<{ [K in keyof T]: Promise<ImageData> }>(input) as any as { promise: Promise<subt>, loaded: boolean, raw: subt } & subt;\r\n}\r\n\r\n","import { ImageDetect, transferImageData } from \"./index\";\r\nimport { RectLike } from \"./rect\";\r\n\r\nexport abstract class ImgRef {\r\n\tpublic width: number;\r\n\tpublic height: number;\r\n\tpublic x: number;\r\n\tpublic y: number;\r\n\tpublic t = \"none\";\r\n\r\n\tconstructor(x: number, y: number, w: number, h: number) {\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.width = w;\r\n\t\tthis.height = h;\r\n\t}\r\n\r\n\tread(x = 0, y = 0, w = this.width, h = this.height): ImageData {\r\n\t\tthrow (\"This imgref (\" + this.t + \") does not support toData\");\r\n\t}\r\n\r\n\tfindSubimage(needle: ImageData, sx = 0, sy = 0, w = this.width, h = this.height) {\r\n\t\treturn ImageDetect.findSubimage(this, needle, sx, sy, w, h);\r\n\t}\r\n\ttoData(x = this.x, y = this.y, w = this.width, h = this.height) {\r\n\t\treturn this.read(x - this.x, y - this.y, w, h);\r\n\t};\r\n\tcontainsArea(rect: RectLike) {\r\n\t\treturn this.x <= rect.x && this.y <= rect.y && this.x + this.width >= rect.x + rect.width && this.y + this.height >= rect.y + rect.height;\r\n\t}\r\n}\r\n\r\nexport class ImgRefCtx extends ImgRef {\r\n\tctx: CanvasRenderingContext2D;\r\n\tconstructor(img: HTMLImageElement | CanvasRenderingContext2D | HTMLCanvasElement, x = 0, y = 0) {\r\n\t\tif (img instanceof CanvasRenderingContext2D) {\r\n\t\t\tsuper(x, y, img.canvas.width, img.canvas.height);\r\n\t\t\tthis.ctx = img;\r\n\t\t} else {\r\n\t\t\tsuper(x, y, img.width, img.height);\r\n\t\t\tvar cnv = (img instanceof HTMLCanvasElement ? img : img.toCanvas());\r\n\t\t\tthis.ctx = cnv.getContext(\"2d\");\r\n\t\t}\r\n\t\tthis.t = \"ctx\";\r\n\t}\r\n\r\n\tread(x = 0, y = 0, w = this.width, h = this.height) {\r\n\t\treturn this.ctx.getImageData(x, y, w, h);\r\n\t}\r\n}\r\n\r\nexport class ImgRefBind extends ImgRef {\r\n\thandle: number;\r\n\tconstructor(handle: number, x = 0, y = 0, w = 0, h = 0) {\r\n\t\tsuper(x, y, w, h);\r\n\t\tthis.handle = handle;\r\n\t\tthis.t = \"bind\";\r\n\t}\r\n\r\n\tread(x = 0, y = 0, w = this.width, h = this.height) {\r\n\t\treturn transferImageData(this.handle, x, y, w, h);\r\n\t}\r\n}\r\n\r\nexport class ImgRefData extends ImgRef {\r\n\tbuf: ImageData;\r\n\tconstructor(buf: ImageData, x = 0, y = 0) {\r\n\t\tsuper(x, y, buf.width, buf.height);\r\n\t\tthis.buf = buf;\r\n\t\tthis.t = \"data\";\r\n\t}\r\n\r\n\tread(x = 0, y = 0, w = this.width, h = this.height) {\r\n\t\tif (x == 0 && y == 0 && w == this.width && h == this.height) {\r\n\t\t\treturn this.buf;\r\n\t\t}\r\n\t\tvar r = new ImageData(w, h);\r\n\t\tfor (var b = y; b < y + h; b++) {\r\n\t\t\tfor (var a = x; a < x + w; a++) {\r\n\t\t\t\tvar i1 = (a - x) * 4 + (b - y) * w * 4;\r\n\t\t\t\tvar i2 = a * 4 + b * 4 * this.buf.width;\r\n\r\n\t\t\t\tr.data[i1] = this.buf.data[i2];\r\n\t\t\t\tr.data[i1 + 1] = this.buf.data[i2 + 1];\r\n\t\t\t\tr.data[i1 + 2] = this.buf.data[i2 + 2];\r\n\t\t\t\tr.data[i1 + 3] = this.buf.data[i2 + 3];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn r;\r\n\t}\r\n}\r\n","///<reference path=\"./alt1.d.ts\" />\r\n///<reference path=\"./alt1lib.d.ts\"/>\r\n\r\nimport * as ImageDetect from \"./imagedetect\";\r\nimport * as PasteInput from \"./pasteinput\";\r\nimport Rect, { RectLike, PointLike } from \"./rect\";\r\nimport { ImageData } from \"./imagedata-extensions\";\r\n\r\nexport { PasteInput, ImageDetect, Rect, RectLike, ImageData, PointLike };\r\nexport * from \"./imgref\";\r\nexport * from \"./wrapper\";\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import { ImgRefCtx } from \"./index\";\r\nimport * as ImageDetect from \"./imagedetect\";\r\n\r\n\r\ntype ImgCallback = (img: HTMLCanvasElement, imgref: ImgRefCtx) => any;\r\ntype ErrorCallback = (text: string, id: string) => any;\r\nvar listeners: { cb: ImgCallback, error: ErrorCallback }[] = [];\r\nvar started = false;\r\nvar dndStarted = false;\r\nvar pasting = false;\r\nexport var lastref: ImgRefCtx | null = null;\r\nexport var lastimg: HTMLCanvasElement | null = null;\r\n\r\nexport function listen(func: any, errorfunc?: any, dragndrop?: boolean) {\r\n\tlisteners.push({ cb: func, error: errorfunc });\r\n\r\n\tif (!started) { start(); }\r\n\tif (dragndrop && !dndStarted) { startDragNDrop(); }\r\n}\r\n\r\nfunction pasted(img: HTMLImageElement) {\r\n\tvar a;\r\n\tpasting = false;\r\n\tlastimg = img.toCanvas();\r\n\tlastref = new ImgRefCtx(lastimg);\r\n\tfor (a in listeners) { listeners[a].cb(lastimg, lastref); }\r\n}\r\n\r\nfunction error(mes: string, error: string) {\r\n\tpasting = false;\r\n\tfor (var a in listeners) {\r\n\t\tif (listeners[a].error) { listeners[a].error(mes, error); }\r\n\t}\r\n}\r\n\r\nexport function startDragNDrop() {\r\n\tvar getitem = function (items: DataTransferItemList) {\r\n\t\tvar foundimage = \"\";\r\n\t\tfor (var a = 0; a < items.length; a++) {\r\n\t\t\tvar item = items[a];\r\n\t\t\tvar m = item.type.match(/^image\\/(\\w+)$/)\r\n\t\t\tif (m) {\r\n\t\t\t\tif (m[1] == \"png\") { return item; }\r\n\t\t\t\telse { foundimage = m[1]; }\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (foundimage) {\r\n\t\t\terror(\"The image you uploaded is not a .png image. Other image type have compression noise and can't be used for image detection.\", \"notpng\");\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\twindow.addEventListener(\"dragover\", function (e) {\r\n\t\te.preventDefault();\r\n\t});\r\n\twindow.addEventListener(\"drop\", function (e) {\r\n\t\tif (!e.dataTransfer) { return; }\r\n\t\tvar item = getitem(e.dataTransfer.items);\r\n\t\te.preventDefault();\r\n\t\tif (!item) { return; }\r\n\t\tfromFile(item.getAsFile());\r\n\t});\r\n}\r\n\r\nexport function start() {\r\n\tif (started) { return; }\r\n\tstarted = true;\r\n\r\n\t//determine if we have a clipboard api\r\n\t//try{a=new Event(\"clipboard\"); a=\"clipboardData\" in a;}\r\n\t//catch(e){a=false;}\r\n\tvar ischrome = !!navigator.userAgent.match(/Chrome/) && !navigator.userAgent.match(/Edge/);\r\n\t//old method breaks after chrome 41, revert to good old user agent sniffing\r\n\t//nvm, internet explorer (edge) decided that it wants to be chrome, however fails at delivering\r\n\r\n\t//turns out this one is interesting, edge is a hybrid between the paste api's\r\n\tvar apipasted = function (e: ClipboardEvent) {\r\n\t\tfor (var a = 0; a < e.clipboardData.items.length; a++) {//loop all data types\r\n\t\t\tif (e.clipboardData.items[a].type.indexOf(\"image\") != -1) {\r\n\t\t\t\tvar file = e.clipboardData.items[a].getAsFile();\r\n\t\t\t\tvar img = new Image();\r\n\t\t\t\timg.src = (window.URL || (window as any).webkitURL).createObjectURL(file);\r\n\t\t\t\tif (img.width > 0) { pasted(img); }\r\n\t\t\t\telse { img.onload = function () { pasted(img); } }\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tif (ischrome) {\r\n\t\tdocument.addEventListener(\"paste\", apipasted);\r\n\t}\r\n\telse {\r\n\t\tvar catcher = document.createElement(\"div\");\r\n\t\tcatcher.setAttribute(\"contenteditable\", \"\");\r\n\t\tcatcher.className = \"forcehidden\";//retarded ie safety/bug, cant apply styles using js//TODO i don't even know what's going on\r\n\t\tcatcher.onpaste = function (e) {\r\n\t\t\tif (e.clipboardData && e.clipboardData.items) { apipasted(e); return; }\r\n\t\t\tsetTimeout(function () {\r\n\t\t\t\tvar b = catcher.children[0] as HTMLImageElement\r\n\t\t\t\tif (!b || b.tagName != \"IMG\") { return; }\r\n\t\t\t\tvar img = new Image();\r\n\t\t\t\timg.src = b.src;\r\n\t\t\t\tvar a = img.src.match(/^data:([\\w\\/]+);/);\r\n\t\t\t\tif (img.width > 0) { pasted(img); }\r\n\t\t\t\telse { img.onload = function () { pasted(img) }; }\r\n\t\t\t\tcatcher.innerHTML = \"\";\r\n\t\t\t}, 1);\r\n\t\t};\r\n\t\tdocument.body.appendChild(catcher);\r\n\t}\r\n\r\n\t//detect if ctrl-v is pressed and focus catcher if needed\r\n\tdocument.addEventListener(\"keydown\", function (e) {\r\n\t\tif ((e.target as HTMLElement).tagName == \"INPUT\") { return; }\r\n\t\tif (e.keyCode != \"V\".charCodeAt(0) || !e.ctrlKey) { return; }\r\n\t\tpasting = true;\r\n\t\tsetTimeout(function () {\r\n\t\t\tif (pasting) { error(\"You pressed Ctrl+V, but no image was pasted by your browser, make sure your clipboard contains an image, and not a link to an image.\\n This may also happen if your browser is (very) outdated.\", \"noimg\"); }\r\n\t\t}, 1000);\r\n\t\tif (catcher) { catcher.focus(); }\r\n\t});\r\n}\r\n\r\nexport function fileDialog() {\r\n\tvar fileinput = document.createElement(\"input\");\r\n\tfileinput.type = \"file\";\r\n\tfileinput.accept = \"image/png\";\r\n\tfileinput.onchange = function () { if (fileinput.files && fileinput.files[0]) { fromFile(fileinput.files[0]); } };\r\n\tfileinput.click();\r\n\treturn fileinput;\r\n}\r\n\r\nfunction fromFile(file: File | null) {\r\n\tif (!file) { return; }\r\n\tvar reader = new FileReader();\r\n\treader.onload = function () {//TODO check if it's actually png\r\n\t\tvar bytearray = new Uint8Array(reader.result as ArrayBuffer);\r\n\t\tif (ImageDetect.isPngBuffer(bytearray)) {\r\n\t\t\tImageDetect.clearPngColorspace(bytearray);\r\n\t\t}\r\n\t\tvar blob = new Blob([bytearray], { type: \"image/png\" });\r\n\t\tvar img = new Image();\r\n\t\timg.onerror = () => error(\"The file you uploaded could not be opened as an image.\", \"invalidfile\");\r\n\t\tvar bloburl = URL.createObjectURL(blob);\r\n\t\timg.src = bloburl;\r\n\t\tif (img.width > 0) { pasted(img); URL.revokeObjectURL(bloburl); }\r\n\t\telse { img.onload = function () { pasted(img); URL.revokeObjectURL(bloburl); }; }\r\n\t};\r\n\r\n\treader.readAsArrayBuffer(file);\r\n}","//util class for rectangle maths\r\n//TODO shit this sucks can we remove it again?\r\n//more of a shorthand to get {x,y,width,height} than a class\r\n//kinda starting to like it again\r\n//TODO remove rant\r\n\r\nexport interface PointLike {\r\n\tx: number,\r\n\ty: number\r\n};\r\n\r\nexport interface RectLike {\r\n\tx: number;\r\n\ty: number;\r\n\twidth: number;\r\n\theight: number;\r\n}\r\n\r\n/**\r\n * Simple rectangle class with some util functions\r\n */\r\nexport default class Rect implements RectLike {\r\n\tx: number;\r\n\ty: number;\r\n\twidth: number;\r\n\theight: number;\r\n\tconstructor(x: number, y: number, w: number, h: number) {\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.width = w;\r\n\t\tthis.height = h;\r\n\t}\r\n\r\n\tstatic fromArgs(obj: RectLike): Rect;\r\n\tstatic fromArgs(xywh: number[]): Rect;\r\n\tstatic fromArgs(x: number, y: number, w: number, h: number): Rect;\r\n\tstatic fromArgs(...args:any[]): Rect\r\n\tstatic fromArgs(...args:any[]): Rect {\r\n\t\tif (typeof args[0] == \"object\") {\r\n\t\t\tif (typeof args[0][0] == \"number\") {\r\n\t\t\t\treturn new Rect(args[0], args[1], args[2], args[3]);\r\n\t\t\t} else {\r\n\t\t\t\treturn new Rect(args[0].x, args[0].y, args[0].width, args[0].height);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn new Rect(args[0], args[1], args[2], args[3]);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Resizes this Rect to include the full size of a given second rectangle\r\n\t */\r\n\tunion(r2: RectLike) {\r\n\t\tvar x = Math.min(this.x, r2.x);\r\n\t\tvar y = Math.min(this.y, r2.y);\r\n\t\tthis.width = Math.max(this.x + this.width, r2.x + r2.width) - x;\r\n\t\tthis.height = Math.max(this.y + this.height, r2.y + r2.height) - y;\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\treturn this;\r\n\t}\r\n\t/**\r\n\t * Resizes this Rect to include a given point\r\n\t */\r\n\tincludePoint(x: number, y: number) {\r\n\t\tthis.union(new Rect(x, y, 0, 0));\r\n\t}\r\n\t/**\r\n\t * Grows the rectangle with the given dimensions\r\n\t */\r\n\tinflate(w: number, h: number) {\r\n\t\tthis.x -= w;\r\n\t\tthis.y -= h;\r\n\t\tthis.width += 2 * w;\r\n\t\tthis.height += 2 * h;\r\n\t}\r\n\t/**\r\n\t * Resizes this Rect to the area that overlaps a given Rect\r\n\t * width and height will be set to 0 if the intersection does not exist\r\n\t */\r\n\tintersect(r2: RectLike) {\r\n\t\tif (this.x < r2.x) { this.width -= r2.x - this.x; this.x = r2.x; }\r\n\t\tif (this.y < r2.y) { this.height -= r2.y - this.y; this.y = r2.y; }\r\n\t\tthis.width = Math.min(this.x + this.width, r2.x + r2.width) - this.x;\r\n\t\tthis.height = Math.min(this.y + this.height, r2.y + r2.height) - this.y;\r\n\t\tif (this.width <= 0 || this.height <= 0) {\r\n\t\t\tthis.width = 0;\r\n\t\t\tthis.height = 0;\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t * Returns wether this Rect has at least one pixel overlap with a given Rect\r\n\t */\r\n\toverlaps(r2: RectLike) {\r\n\t\treturn this.x < r2.x + r2.width && this.x + this.width > r2.x && this.y < r2.y + r2.height && this.y + this.height > r2.y;\r\n\t}\r\n\t/**\r\n\t * Returns wether a given Rect fits completely inside this Rect\r\n\t * @param r2\r\n\t */\r\n\tcontains(r2: RectLike) {\r\n\t\treturn this.x <= r2.x && this.x + this.width >= r2.x + r2.width && this.y <= r2.y && this.y + this.height >= r2.y + r2.height;\r\n\t}\r\n\t/**\r\n\t * Returns wether a given point lies inside this Rect\r\n\t */\r\n\tcontainsPoint(x: number, y: number) {\r\n\t\treturn this.x <= x && this.x + this.width > x && this.y <= y && this.y + this.height > y;\r\n\t}\r\n}","import * as ImageDetect from \"./imagedetect\";\r\nimport Rect, { RectLike } from \"./rect\";\r\nimport { ImgRefBind, ImgRefCtx, ImgRefData, ImgRef } from \"./imgref\";\r\nimport \"./imagedata-extensions\";\r\n\r\ndeclare global {\r\n\tnamespace alt1 {\r\n\t\tvar events: { [event: string]: Alt1EventHandler[] };\r\n\t}\r\n}\r\n\r\n/**\r\n * Thrown when a method is called that can not be used outside of Alt1\r\n */\r\nexport class NoAlt1Error extends Error {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.message = \"This method can not be ran outside of Alt1\";\r\n\t}\r\n};\r\n/**\r\n * Thrown when the Alt1 API returns an invalid result\r\n * Errors of a different type are throw when internal Alt1 errors occur\r\n */\r\nexport class Alt1Error extends Error { }\r\n\r\n/**\r\n * The latest Alt1 version\r\n */\r\nexport var newestversion = \"1.5.3\";\r\n\r\n/**\r\n * Wether the Alt1 API is available\r\n */\r\nexport var hasAlt1 = (typeof alt1 != \"undefined\");\r\n\r\n/**\r\n * The name of the Alt1 interface skin. (Always \"default\" if running in a browser)\r\n */\r\nexport var skinName = hasAlt1 ? alt1.skinName : \"default\";\r\n\r\n/**\r\n * Max number of bytes that can be sent by alt1 in one function\r\n * Not completely sure why this number is different than window.alt1.maxtranfer\r\n */\r\nvar maxtransfer = 4000000;\r\n\r\n/**\r\n * Open a link in the default browser\r\n * @deprecated use window.open instead\r\n */\r\nexport function openbrowser(url: string) {\r\n\tif (hasAlt1) {\r\n\t\talt1.openBrowser(url);\r\n\t}\r\n\telse {\r\n\t\twindow.open(url, '_blank');\r\n\t}\r\n}\r\n\r\n/**\r\n * Throw if Alt1 API is not available\r\n */\r\nexport function requireAlt1() {\r\n\tif (!hasAlt1) { throw new NoAlt1Error(); }\r\n}\r\n\r\n/**\r\n * Returns an object with a rectangle that spans all screens\r\n */\r\nexport function getdisplaybounds() {\r\n\tif (!hasAlt1) { return false; }\r\n\treturn new Rect(alt1.screenX, alt1.screenY, alt1.screenWidth, alt1.screenHeight);\r\n}\r\n\r\n/**\r\n * gets an imagebuffer with pixel data about the requested region\r\n */\r\nexport function capture(x: number, y: number, w: number, h: number): ImageData;\r\nexport function capture(rect: RectLike): ImageData;\r\nexport function capture(...args: any[]): ImageData | null {\r\n\tif (!hasAlt1) { throw new NoAlt1Error(); }\r\n\tvar i = 0;\r\n\r\n\tvar rect = Rect.fromArgs(...args);\r\n\r\n\tvar buf = new ImageData(rect.width, rect.height);\r\n\r\n\tif (rect.width * rect.height * 4 <= maxtransfer) {\r\n\t\tvar data = alt1.getRegion(rect.x, rect.y, rect.width, rect.height);\r\n\t\tif (!data) { return null; }\r\n\t\tdecodeImageString(data, buf, 0, 0, rect.width, rect.height);\r\n\t}\r\n\telse {\r\n\t\t//split up the request to to exceed the single transfer limit (for now)\r\n\t\tvar x1 = rect.x;\r\n\t\tvar ref = alt1.bindRegion(rect.x, rect.y, rect.width, rect.height);\r\n\t\tif (ref <= 0) { return null; }\r\n\t\twhile (x1 < rect.x + rect.width) {\r\n\t\t\tvar x2 = Math.min(rect.x + rect.width, Math.floor(x1 + (maxtransfer / 4 / rect.height)));\r\n\t\t\tvar data = alt1.bindGetRegion(ref, x1, rect.y, x2 - x1, rect.height);\r\n\t\t\tif (!data) { return null; }\r\n\t\t\tdecodeImageString(data, buf, x1 - rect.x, 0, x2 - x1, rect.height);\r\n\t\t\tx1 = x2;\r\n\t\t}\r\n\t}\r\n\treturn buf;\r\n}\r\n\r\n/**\r\n * Makes alt1 bind an area of the rs client in memory without sending it to the js client\r\n * returns an imgref object which can be used to get pixel data using the imgreftobuf function\r\n * currently only one bind can exist per app and the ref in (v) will always be 1\r\n */\r\nexport function captureHold(x: number, y: number, w: number, h: number) {\r\n\tx = Math.round(x); y = Math.round(y); w = Math.round(w); h = Math.round(h);\r\n\trequireAlt1();\r\n\tvar r = alt1.bindRegion(x, y, w, h);\r\n\tif (r <= 0) { throw new Alt1Error(\"capturehold failed\"); }\r\n\treturn new ImgRefBind(r, x, y, w, h);\r\n}\r\n\r\n/**\r\n * Same as captureHoldRegion, but captures the screen instead of the rs client. it also uses screen coordinates instead and can capture outside of the rs client\r\n */\r\nexport function captureHoldScreen(x: number, y: number, w: number, h: number) {\r\n\tx = Math.round(x); y = Math.round(y); w = Math.round(w); h = Math.round(h);\r\n\trequireAlt1();\r\n\tvar r = alt1.bindScreenRegion(x, y, w, h);\r\n\tif (r <= 0) { return false; }\r\n\treturn new ImgRefBind(r, x, y, w, h);\r\n}\r\n\r\n/**\r\n * bind the full rs window if the rs window can be detected by alt1, otherwise return the full screen\r\n */\r\nexport function captureHoldFullRs() {\r\n\treturn captureHold(0, 0, alt1.rsWidth, alt1.rsHeight);\r\n}\r\n\r\n/**\r\n * returns a subregion from a bound image\r\n * used internally in imgreftobuf if imgref is a bound image\r\n * @deprecated This should be handled internall by the imgrefbind.toData method\r\n */\r\nexport function transferImageData(handle: number, x: number, y: number, w: number, h: number) {\r\n\tx = Math.round(x); y = Math.round(y); w = Math.round(w); h = Math.round(h);\r\n\trequireAlt1();\r\n\r\n\tvar r = new ImageData(w, h);\r\n\r\n\tvar x1 = x;\r\n\twhile (true) {//split up the request to to exceed the single transfer limit (for now)\r\n\t\tvar x2 = Math.min(x + w, Math.floor(x1 + (maxtransfer / 4 / h)));\r\n\t\tvar a = alt1.bindGetRegion(handle, x1, y, x2 - x1, h);\r\n\t\tif (!a) { throw new Alt1Error(); }\r\n\t\tdecodeImageString(a, r, x1 - x, 0, x2 - x1, h);\r\n\t\tx1 = x2;\r\n\t\tif (x1 == x + w) { break; };\r\n\t}\r\n\treturn r;\r\n}\r\n\r\n/**\r\n * decodes a returned string from alt1 to an imagebuffer\r\n */\r\nexport function decodeImageString(imagestring: string, target: ImageData, x: number, y: number, w: number, h: number) {\r\n\tvar bin = atob(imagestring);\r\n\r\n\tvar bytes = target.data;\r\n\r\n\tw |= 0;\r\n\th |= 0;\r\n\tvar offset = 4 * x + 4 * y * target.width;\r\n\tvar target_width = target.width | 0;\r\n\tfor (var a = 0; a < w; a++) {\r\n\t\tfor (var b = 0; b < h; b++) {\r\n\t\t\tvar i1 = (offset + (a * 4 | 0) + (b * target_width * 4 | 0)) | 0;\r\n\t\t\tvar i2 = ((a * 4 | 0) + (b * 4 * w | 0)) | 0;\r\n\t\t\tbytes[i1 + 0 | 0] = bin.charCodeAt(i2 + 2 | 0);//fix weird red/blue swap in c#\r\n\t\t\tbytes[i1 + 1 | 0] = bin.charCodeAt(i2 + 1 | 0);\r\n\t\t\tbytes[i1 + 2 | 0] = bin.charCodeAt(i2 + 0 | 0);\r\n\t\t\tbytes[i1 + 3 | 0] = bin.charCodeAt(i2 + 3 | 0);\r\n\t\t}\r\n\t}\r\n\treturn target;\r\n}\r\n\r\n/**\r\n * encodes an imagebuffer to a string\r\n */\r\nexport function encodeImageString(buf: ImageData, sx = 0, sy = 0, sw = buf.width, sh = buf.height) {\r\n\tvar raw = \"\";\r\n\tfor (var y = sy; y < sy + sh; y++) {\r\n\t\tfor (var x = sx; x < sx + sw; x++) {\r\n\t\t\tvar i = 4 * x + 4 * buf.width * y | 0;\r\n\t\t\traw += String.fromCharCode(buf.data[i + 2 | 0]);\r\n\t\t\traw += String.fromCharCode(buf.data[i + 1 | 0]);\r\n\t\t\traw += String.fromCharCode(buf.data[i + 0 | 0]);\r\n\t\t\traw += String.fromCharCode(buf.data[i + 3 | 0]);\r\n\t\t}\r\n\t}\r\n\treturn btoa(raw);\r\n}\r\n\r\n/**\r\n * mixes the given color into a single int. This format is used by alt1\r\n */\r\nexport function mixColor(r: number, g: number, b: number, a = 255) {\r\n\treturn (b << 0) + (g << 8) + (r << 16) + (a << 24);\r\n}\r\n\r\n\r\nexport function identifyApp(url: string) {\r\n\tif (hasAlt1) { alt1.identifyAppUrl(url); }\r\n}\r\n\r\nfunction convertAlt1Version(str: string) {\r\n\tvar a = str.match(/^(\\d+)\\.(\\d+)\\.(\\d+)$/);\r\n\tif (!a) { throw new RangeError(\"Invalid version string\"); }\r\n\treturn (+a[1]) * 1000 * 1000 + (+a[2]) * 1000 + (+a[3]) * 1;\r\n}\r\n\r\nvar cachedVersionInt = -1\r\n/**\r\n * checks if alt1 is running and at least the given version. versionstr should be a string with the version eg: 1.3.2\r\n * @param versionstr\r\n */\r\nexport function hasAlt1Version(versionstr: string) {\r\n\tif (!hasAlt1) { return false; }\r\n\tif (cachedVersionInt == -1) { cachedVersionInt = alt1.versionint; }\r\n\treturn cachedVersionInt >= convertAlt1Version(versionstr);\r\n}\r\n\r\n/**\r\n * Gets the current cursor position in the game, returns null if the rs window is not active (alt1.rsActive)\r\n */\r\nexport function getMousePosition() {\r\n\tvar pos = alt1.mousePosition;\r\n\tif (pos == -1) { return null; }\r\n\treturn { x: pos >>> 16, y: pos & 0xFFFF };\r\n}\r\n/**\r\n * Registers a given HTML element as a frame border, when this element is dragged by the user the Alt1 frame will resize accordingly\r\n * Use the direction arguements to make a given direction stick to the mouse. eg. Only set left to true to make the element behave as the left border\r\n * Or set all to true to move the whole window. Not all combinations are permitted\r\n */\r\nexport function addResizeElement(el: HTMLElement, left: boolean, top: boolean, right: boolean, bot: boolean) {\r\n\tif (!hasAlt1 || !alt1.userResize) { return; }\r\n\tel.addEventListener(\"mousedown\", function (e) {\r\n\t\talt1.userResize(left, top, right, bot);\r\n\t\te.preventDefault();\r\n\t});\r\n}\r\n\r\n\r\n\r\nexport type Alt1EventHandler = (e: any) => void;\r\n\r\n/**\r\n * Add an event listener\r\n */\r\nexport function on<K extends keyof Alt1EventType>(type: K, listener: (ev: Alt1EventType[K]) => void) {\r\n\trequireAlt1();\r\n\tif (!alt1.events) { alt1.events = {}; }\r\n\tif (!alt1.events[type]) { alt1.events[type] = []; }\r\n\talt1.events[type].push(listener);\r\n}\r\n\r\n/**\r\n * Removes an event listener\r\n */\r\nexport function removeListener<K extends keyof Alt1EventType>(type: K, listener: (ev: Alt1EventType[K]) => void) {\r\n\tvar elist = alt1.events && alt1.events[type];\r\n\tif (!elist) { return; }\r\n\tvar i = elist.indexOf(listener);\r\n\tif (i == -1) { return; }\r\n\telist.splice(i, 1);\r\n}\r\n\r\n/**\r\n * Listens for the event to fire once and then stops listening\r\n * @param event\r\n * @param cb\r\n */\r\nexport function once<K extends keyof Alt1EventType>(type: K, listener: (ev: Alt1EventType[K]) => void) {\r\n\trequireAlt1();\r\n\tvar fn = (e: Alt1EventType[K]) => {\r\n\t\tremoveListener(type, fn);\r\n\t\tlistener(e);\r\n\t};\r\n\ton(type, fn);\r\n}\r\ninterface Alt1EventType {\r\n\t\"alt1pressed\": { eventName: \"alt1pressed\", text: string, mouseAbs: { x: number, y: number }, mouseRs: { x: number, y: number }, x: number, y: number, rsLinked: boolean },\r\n\t\"menudetected\": { eventName: \"menudetected\", rectangle: { x: number, y: number, width: number, height: number } },\r\n\t\"rslinked\": { eventName: \"rslinked\" },\r\n\t\"rsunlinked\": { eventName: \"rsunlinked\" },\r\n\t\"permissionchanged\": { eventName: \"permissionchanged\" },\r\n\t\"daemonrun\": { eventName: \"daemonrun\", result: { now: number, nextRun: number, state: string, messages: { [id: string]: { title: string, body: string } }, statusXml: string } },\r\n\t\"userevent\": { eventName: \"userevent\", argument: string },\r\n\t\"rsfocus\": { eventName: \"rsfocus\" },\r\n\t\"rsblur\": { eventName: \"rsblur\" },\r\n};\r\n\r\n/**\r\n * Used to read a set of images from a binary stream returned by the Alt1 API\r\n */\r\nexport class ImageStreamReader {\r\n\tprivate framebuffer: ImageData = null;\r\n\tprivate streamreader: ReadableStreamReader;\r\n\tprivate pos = 0;\r\n\tprivate reading = false;\r\n\tclosed = false;\r\n\r\n\t//paused state\r\n\tprivate pausedindex = -1;\r\n\tprivate pausedbuffer: Uint8Array | null = null;\r\n\r\n\tconstructor(reader: ReadableStreamReader, width: number, height: number);\r\n\tconstructor(reader: ReadableStreamReader, framebuffer: ImageData);\r\n\tconstructor(reader: ReadableStreamReader);\r\n\tconstructor(reader: ReadableStreamReader, ...args: any[]) {\r\n\t\tthis.streamreader = reader;\r\n\t\tif (args[0] instanceof ImageData) { this.setFrameBuffer(args[0]); }\r\n\t\telse if (typeof args[0] == \"number\") { this.setFrameBuffer(new ImageData(args[0], args[1])); }\r\n\t}\r\n\r\n\t/**\r\n\t * \r\n\t */\r\n\tsetFrameBuffer(buffer: ImageData) {\r\n\t\tif (this.reading) { throw new Error(\"can't change framebuffer while reading\"); }\r\n\t\tthis.framebuffer = buffer;\r\n\t}\r\n\r\n\t/**\r\n\t * Closes the underlying stream and ends reading\r\n\t */\r\n\tclose() {\r\n\t\tthis.streamreader.cancel();\r\n\t}\r\n\r\n\t/**\r\n\t * Reads a single image from the stream\r\n\t */\r\n\tasync nextImage() {\r\n\t\tif (this.reading) { throw new Error(\"already reading from this stream\"); }\r\n\t\tif (!this.framebuffer) { throw new Error(\"framebuffer not set\"); }\r\n\t\tthis.reading = true;\r\n\t\tvar synctime = -Date.now();\r\n\t\tvar starttime = Date.now();\r\n\t\tvar r = false;\r\n\t\twhile (!r) {\r\n\t\t\tif (this.pausedindex != -1 && this.pausedbuffer) {\r\n\t\t\t\tr = this.readChunk(this.pausedindex, this.framebuffer.data, this.pausedbuffer);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tsynctime += Date.now();\r\n\t\t\t\tvar res = await this.streamreader.read() as { value: Uint8Array, done: boolean };\r\n\t\t\t\tsynctime -= Date.now();\r\n\t\t\t\tif (res.done) { throw new Error(\"Stream closed while reading\"); }\r\n\t\t\t\tvar data = res.value;\r\n\t\t\t\tr = this.readChunk(0, this.framebuffer.data, data);\r\n\t\t\t}\r\n\t\t}\r\n\t\tsynctime += Date.now();\r\n\t\t//console.log(\"Decoded async image, \" + this.framebuffer.width + \"x\" + this.framebuffer.height + \" time: \" + (Date.now() - starttime) + \"ms (\" + synctime + \"ms main thread)\");\r\n\t\tthis.reading = false;\r\n\t\treturn this.framebuffer;\r\n\t}\r\n\r\n\tprivate readChunk(i: number, framedata: Uint8ClampedArray, buffer: Uint8Array) {\r\n\t\t//very hot code, explicit int32 casting with |0 speeds it up by ~ x2\r\n\t\ti = i | 0;\r\n\t\tvar framesize = framedata.length | 0;\r\n\t\tvar pos = this.pos;\r\n\t\tvar datalen = buffer.length | 0;\r\n\t\t//var data32 = new Float64Array(buffer.buffer);\r\n\t\t//var framedata32 = new Float64Array(framedata.buffer);\r\n\r\n\t\t//fix possible buffer misalignment\r\n\t\t//align to 16 for extra loop unrolling\r\n\t\twhile (i < datalen) {\r\n\t\t\t//slow loop, fix alignment and other issues\r\n\t\t\twhile (i < datalen && pos < framesize && (pos % 16 != 0 || !((i + 16 | 0) <= datalen && (pos + 16 | 0) <= framesize))) {\r\n\t\t\t\tvar rel = pos;\r\n\t\t\t\tif (pos % 4 == 0) { rel = rel + 2 | 0; }\r\n\t\t\t\tif (pos % 4 == 2) { rel = rel - 2 | 0; }\r\n\t\t\t\tframedata[rel | 0] = buffer[i | 0];\r\n\t\t\t\ti = i + 1 | 0;\r\n\t\t\t\tpos = pos + 1 | 0;\r\n\t\t\t}\r\n\r\n\t\t\t//fast unrolled loop for large chunks i wish js had some sort of memcpy\r\n\t\t\tif (pos % 16 == 0) {\r\n\t\t\t\twhile ((i + 16 | 0) <= datalen && (pos + 16 | 0) <= framesize) {\r\n\t\t\t\t\tframedata[pos + 0 | 0] = buffer[i + 2 | 0];\r\n\t\t\t\t\tframedata[pos + 1 | 0] = buffer[i + 1 | 0];\r\n\t\t\t\t\tframedata[pos + 2 | 0] = buffer[i + 0 | 0];\r\n\t\t\t\t\tframedata[pos + 3 | 0] = buffer[i + 3 | 0];\r\n\r\n\t\t\t\t\tframedata[pos + 4 | 0] = buffer[i + 6 | 0];\r\n\t\t\t\t\tframedata[pos + 5 | 0] = buffer[i + 5 | 0];\r\n\t\t\t\t\tframedata[pos + 6 | 0] = buffer[i + 4 | 0];\r\n\t\t\t\t\tframedata[pos + 7 | 0] = buffer[i + 7 | 0];\r\n\r\n\t\t\t\t\tframedata[pos + 8 | 0] = buffer[i + 10 | 0];\r\n\t\t\t\t\tframedata[pos + 9 | 0] = buffer[i + 9 | 0];\r\n\t\t\t\t\tframedata[pos + 10 | 0] = buffer[i + 8 | 0];\r\n\t\t\t\t\tframedata[pos + 11 | 0] = buffer[i + 11 | 0];\r\n\r\n\t\t\t\t\tframedata[pos + 12 | 0] = buffer[i + 14 | 0];\r\n\t\t\t\t\tframedata[pos + 13 | 0] = buffer[i + 13 | 0];\r\n\t\t\t\t\tframedata[pos + 14 | 0] = buffer[i + 12 | 0];\r\n\t\t\t\t\tframedata[pos + 15 | 0] = buffer[i + 15 | 0];\r\n\r\n\t\t\t\t\t//could speed it up another x2 but wouldn't be able to swap r/b swap and possible alignment issues\r\n\t\t\t\t\t//framedata32[pos / 8 + 0 | 0] = data32[i / 8 + 0 | 0];\r\n\t\t\t\t\t//framedata32[pos / 8 + 1 | 0] = data32[i / 8 + 1 | 0];\r\n\t\t\t\t\t//framedata32[pos / 4 + 2 | 0] = data32[i / 4 + 2 | 0];\r\n\t\t\t\t\t//framedata32[pos / 4 + 3 | 0] = data32[i / 4 + 3 | 0];\r\n\r\n\t\t\t\t\tpos = pos + 16 | 0;\r\n\t\t\t\t\ti = i + 16 | 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (pos >= framesize) {\r\n\t\t\t\tthis.pausedbuffer = null;\r\n\t\t\t\tthis.pausedindex = -1;\r\n\r\n\t\t\t\tthis.pos = 0;\r\n\t\t\t\tif (i != buffer.length - 1) {\r\n\t\t\t\t\tthis.pausedbuffer = buffer;\r\n\t\t\t\t\tthis.pausedindex = i;\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.pos = pos;\r\n\t\tthis.pausedbuffer = null;\r\n\t\tthis.pausedindex = -1;\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\ntype asyncCaptureFormat = \"png\" | \"raw\" | \"jpeg\";\r\n\r\n/**\r\n * Asynchronously captures a section of the game screen\r\n */\r\nexport async function captureAsync(rect: RectLike, format?: asyncCaptureFormat, quality?: number): Promise<ImageData>;\r\nexport async function captureAsync(x: number, y: number, width: number, height: number, format?: asyncCaptureFormat, quality?: number): Promise<ImageData>;\r\nexport async function captureAsync(...args: any[]): Promise<ImageData> {\r\n\trequireAlt1();\r\n\tvar i = 0;\r\n\tvar rect = (typeof args[i] == \"object\" ? args[i++] : { x: args[i++], y: args[i++], width: args[i++], height: args[i++] });\r\n\tvar format = args[i++] || \"raw\";\r\n\tvar quality = args[i++] || 0.6;\r\n\tif (!hasAlt1Version(\"1.4.6\")) {\r\n\t\treturn capture(rect.x, rect.y, rect.width, rect.height);\r\n\t}\r\n\tvar url = \"https://alt1api/pixel/getregion/\" + encodeURIComponent(JSON.stringify({ ...rect, format, quality }));\r\n\tif (format == \"raw\") {\r\n\t\tvar res = await fetch(url);\r\n\t\tvar imgreader = new ImageStreamReader(res.body.getReader(), rect.width, rect.height);\r\n\t\treturn imgreader.nextImage();\r\n\t} else {\r\n\t\treturn ImageDetect.imageDataFromUrl(url);\r\n\t}\r\n}\r\n\r\n/**\r\n * Asynchronously captures multple area's. This method captures the images in the same render frame if possible\r\n * @param areas \r\n */\r\nexport async function captureMultiAsync<T extends { [id: string]: RectLike }>(areas: T) {\r\n\trequireAlt1();\r\n\tvar format = \"raw\" as asyncCaptureFormat;\r\n\tvar quality = 0.6;\r\n\r\n\tvar r = {} as { [K in keyof T]: ImageData };\r\n\tvar capts = [] as RectLike[];\r\n\tvar captids = [] as string[];\r\n\tfor (var id in areas) {\r\n\t\tif (areas[id]) { capts.push(areas[id]); captids.push(id); }\r\n\t\telse { r[id] = null; }\r\n\t}\r\n\tif (!hasAlt1Version(\"1.5.1\")) {\r\n\t\tvar proms = [] as Promise<ImageData>[];\r\n\t\tfor (var a = 0; a < capts.length; a++) { proms.push(captureAsync(capts[a], format, quality)); }\r\n\t\tvar results = await Promise.all(proms);\r\n\t\tfor (var a = 0; a < capts.length; a++) { r[captids[a]] = results[a]; }\r\n\t} else {\r\n\t\tvar res = await fetch(\"https://alt1api/pixel/getregionmulti/\" + encodeURIComponent(JSON.stringify({ areas: capts, format, quality })));\r\n\t\tvar imgreader = new ImageStreamReader(res.body.getReader());\r\n\t\tfor (var a = 0; a < capts.length; a++) {\r\n\t\t\tvar capt = capts[a];\r\n\t\t\timgreader.setFrameBuffer(new ImageData(capt.width, capt.height));\r\n\t\t\tr[captids[a]] = await imgreader.nextImage();\r\n\t\t}\r\n\t}\r\n\treturn r;\r\n}\r\n\r\nexport type CaptureStreamResult = { x: number, y: number, width: number, height: number, framenr: number, close: () => void, closed: boolean };\r\n\r\n/**\r\n * Starts capturing a realtime stream of the game. Make sure you keep reading the stream and close it when you're done or Alt1 WILL crash\r\n * @param framecb Called whenever a new frame is decoded\r\n * @param errorcb Called whenever an error occurs, the error is rethrown if not defined\r\n * @param fps Maximum fps of the stream\r\n */\r\nexport function captureStream(x: number, y: number, width: number, height: number, fps: number, framecb: (img: ImageData) => void, errorcb?: (e: Error) => void): CaptureStreamResult {\r\n\trequireAlt1();\r\n\tif (!hasAlt1Version(\"1.4.6\")) { throw new Alt1Error(\"This function is not supported in this version of Alt1\"); }\r\n\tvar url = \"https://alt1api/pixel/streamregion/\" + encodeURIComponent(JSON.stringify({ x, y, width, height, fps, format: \"raw\" }));\r\n\tvar res = fetch(url).then(async res => {\r\n\t\tvar reader = new ImageStreamReader(res.body!.getReader(), width, height);\r\n\t\ttry {\r\n\t\t\twhile (!reader.closed && !state.closed) {\r\n\t\t\t\tvar img = await reader.nextImage();\r\n\t\t\t\tif (!state.closed) {\r\n\t\t\t\t\tframecb(img);\r\n\t\t\t\t\tstate.framenr++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tif (!state.closed) {\r\n\t\t\t\treader.close();\r\n\t\t\t\tif (errorcb) { errorcb(e); }\r\n\t\t\t\telse { throw e; }\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!reader.closed && state.closed) {\r\n\t\t\treader.close();\r\n\t\t}\r\n\t});\r\n\tvar state = {\r\n\t\tx, y, width, height,\r\n\t\tframenr: 0,\r\n\t\tclose: () => { state.closed = true; },\r\n\t\tclosed: false,\r\n\t};\r\n\treturn state;\r\n}\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE_node_fetch__;","module.exports = __WEBPACK_EXTERNAL_MODULE_pngjs__;"],"sourceRoot":""}